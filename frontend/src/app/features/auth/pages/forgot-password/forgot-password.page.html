<div class="auth-container">
  @if (!submitted()) {
    <form [formGroup]="form" (ngSubmit)="submit()" novalidate>
      <h1>Forgot Password</h1>
      <p class="subtitle">Enter your email and we'll send you a reset link.</p>

      <!-- Global error message (for non-security errors) -->
      @if (errorMessage()) {
        <div class="error-banner" role="alert" aria-live="polite">
          {{ errorMessage() }}
        </div>
      }

      <!-- Email -->
      <div class="form-field">
        <label for="email">Email</label>
        <input
          id="email"
          type="email"
          formControlName="email"
          [attr.aria-invalid]="isEmailInvalid()"
          [attr.aria-describedby]="isEmailInvalid() ? 'email-error' : null"
          autocomplete="email"
        />
        @if (isEmailInvalid()) {
          <small id="email-error" class="error" role="alert">
            @if (emailControl().errors?.['required']) {
              Email is required.
            } @else if (emailControl().errors?.['email']) {
              Please enter a valid email address.
            }
          </small>
        }
      </div>

      <button 
        type="submit" 
        [disabled]="submitting()"
        [attr.aria-busy]="submitting()"
      >
        {{ submitting() ? 'Sending…' : 'Send reset link' }}
      </button>

      <p class="back-link">
        Remember your password? <a routerLink="/login">Sign in</a>
      </p>
    </form>
  }

  <!-- Success state -->
  @if (submitted()) {
    <div class="success-state" role="status" aria-live="polite">
      <div class="success-icon">✓</div>
      <h2>Check your email</h2>
      <p>
        If an account exists for this email, a password reset link has been sent.
        Please check your inbox and spam folder.
      </p>
      <button 
        type="button" 
        class="btn-secondary"
        (click)="resetForm()"
      >
        Try another email
      </button>
      <p class="back-link">
        <a routerLink="/login">Back to login</a>
      </p>
    </div>
  }
</div>