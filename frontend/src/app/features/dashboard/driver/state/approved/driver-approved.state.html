<!-- CURRENT DELIVERY -->
@if (activeBooking()) {

<section class="current-delivery-section">
  <div class="section-header">
    <h2>Current Delivery</h2>
    <span class="live-pill">Live</span>
  </div>

  <section class="card current-delivery">

    <div class="delivery-panel">

      <div class="delivery-top">
        <span class="status-pill">
          <span class="dot"></span>
          {{ activeBooking()!.status }}
        </span>

        <span class="order-id">
          Booking #{{ activeBooking()!.id | slice:0:8 }}
        </span>
      </div>

      <h3 class="delivery-title">
        {{ activeBooking()!.shipments[0]?.pickupAddress }}
        â†’
        {{ activeBooking()!.shipments[0]?.deliveryAddress }}
      </h3>

      <div class="delivery-top-right-earning">
        <div class="earning-block">
          <span class="earning-label">Earning</span>
          <span class="earning-value">
            {{ activeBooking()!.driverEarnings | currency }}
          </span>
        </div>
      </div>

      <button
        class="btn btn--primary btn-full"
        routerLink="/dashboard/driver/booking/{{ activeBooking()!.id }}"
      >
        View delivery
        <mat-icon>arrow_forward</mat-icon>
      </button>

    </div>

  </section>
</section>

}


<!-- AVAILABLE DELIVERIES -->
<section class="available-deliveries">
  <div class="section-header">
    <h2>Available Deliveries</h2>

    <a class="link" routerLink="/dashboard/driver/matching">
      Find deliveries <mat-icon>open_in_new</mat-icon>
    </a>
  </div>

  @if (matches().length === 0) {
    <div class="empty-state card">
      <mat-icon>map_off</mat-icon>
      <p>No deliveries nearby at the moment</p>
    </div>
  } @else {
    <div class="delivery-grid">
      @for (m of matches(); track m.shipment.id) {

        <article class="card delivery-card">

          <div class="card-media">
            <span class="card-icon">
              <mat-icon>inventory_2</mat-icon>
            </span>

            <span class="distance-pill">
              {{ m.metrics.distanceToPickupKm | number:'1.1-1' }} km
            </span>
          </div>

          <div class="card-body">
            <div class="card-title-row">
              <h4>{{ m.shipment.packageDescription || 'Shipment' }}</h4>
              <span class="price">
                {{ m.shipment.basePrice | currency }}
              </span>
            </div>

            <p class="route">
              {{ m.shipment.pickupAddress }}
              <mat-icon>arrow_forward</mat-icon>
              {{ m.shipment.deliveryAddress }}
            </p>

            <div class="tag-row">
              <span class="tag">
                {{ m.shipment.packageWeight }} kg
              </span>

              <span class="tag tag--info">
                {{ m.metrics.pickupToDeliveryKm | number:'1.0-0' }} km route
              </span>
            </div>

            <a
              class="btn btn--secondary btn-full"
              routerLink="/dashboard/driver/matching"
            >
              View details
            </a>
          </div>

        </article>
      }
    </div>
  }
</section>


<!-- EARNINGS SUMMARY -->
<section class="card earnings-summary">
  <div class="earnings-left">
    <div class="earnings-icon">
      <mat-icon>payments</mat-icon>
    </div>
    <div>
      <div class="earnings-title">Earnings Summary</div>
      <div class="earnings-sub">Overview of your totals</div>
    </div>
  </div>

  <div class="earnings-right">
    <div class="earning-col">
      <div class="label">TODAY</div>
      <div class="value">$45.00</div>
    </div>

    <div class="divider"></div>

    <div class="earning-col">
      <div class="label">THIS WEEK</div>
      <div class="value">$310.00</div>
    </div>
  </div>
</section>